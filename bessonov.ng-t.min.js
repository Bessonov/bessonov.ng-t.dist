/*! bessonov.ng-t - v0.0.6 - 2016-06-04 *//**
* The MIT License (MIT)
* Copyright (c) 2016-2016 Anton Bessonov
*/
!function(a){"use strict";a.module("bessonov.ng-t",["ng","ngLocale"])}(angular),function(a){"use strict";a.module("bessonov.ng-t").directive("t",["$compile","$rootScope","t",function(a,b,c){return{restrict:"AE",scope:{t:"=",tParams:"="},compile:function(d){var e=d.html();return function(d,f){var g=function(){var b=d.tParams||d.t;c.translate(e,b).then(function(b){f.html(b),a(f.contents())(d)})};b.$on("tLanguageChangedSuccessful",g),g()}}}}])}(angular),function(a){"use strict";a.module("bessonov.ng-t").filter("t",["$parse","t",function(b,c){var d=function(d,e){a.isString(e)&&(e=b(e)(this));var f=c.translateLoaded(d,e);return f||d};return d.$stateful=!0,d}])}(angular),function(a,b){"use strict";a.module("bessonov.ng-t").service("translateStorageLocalstorage",function(){var a="translation.lang";return{get:function(){return b.getItem(a)},set:function(c){null===c?b.removeItem(a):b.setItem(a,c)}}})}(angular,localStorage),function(a){"use strict";a.module("bessonov.ng-t").factory("NgtModule",["$q","$http",function(a,b){var c=function(c,d,e){var f=c,g=d.getKey(),h=e,i=!1,j=null,k=!1,l=!1,m=null,n={};return{getName:function(){return h},getLoaded:function(){return i},getProvided:function(){return k},getAdded:function(){return l},setAdded:function(a){return l=a,this},provide:function(a){return k=!0,i=!0,n=a,this},contains:function(a){if(i===!1)throw new Error("Module isn't loaded");return a in n},getTranslationLoaded:function(a){if(i===!1)throw new Error("Module isn't loaded");return n[a]},load:function(c){var d=this,e=!c;return(null===j||e===!1)&&(j=a.defer()),i&&e?j.resolve(d):null===m&&(m=b({method:"GET",url:f(g,h),cache:e}).then(function(a){return n=a.data,i=!0,m=null,j.resolve(d),n})),j.promise},reload:function(){return this.load(!0)},getTranslation:function(b){return i?a.when(n[b]):this.load().then(function(){return this.getTranslationLoaded(b)})}}};return c}]).factory("NgtLang",["$q","NgtModule",function(a,b){var c=function(c,d){var e=c,f=d,g=[];return{getKey:function(){return f},addModule:function(a){return g.push(a),this},getModules:function(){return g.slice(0)},getModule:function(a,b){for(var c=0;c<g.length;c++){var d=g[c];if(d.getName()===a)return d}if(b)return null;throw new Error('Module "'+a+'" is unknown')},getOrCreateModule:function(a){var c=this.getModule(a,!0);return null===c&&(c=new b(e,this,a),this.addModule(c)),c},load:function(){for(var b=[],c=0;c<g.length;c++){var d=g[c];d.getLoaded()===!1&&b.push(d.load())}return a.all(b)},getTranslationLoaded:function(a){for(var b=0;b<g.length;b++){var c=g[b];if(c.getLoaded()&&c.contains(a))return c.getTranslationLoaded(a)}return void this.load()},getTranslation:function(b){var c=this.getTranslationLoaded(b);return c?a.when(c):this.load().then(function(a){for(var c=0;c<a.length;c++){var d=a[c];if(d.contains(b))return d.getTranslationLoaded(b)}throw new Error('Translation for "'+b+'" for language "'+f+'" is unknown.')})}}};return c}]).provider("t",function(){var b,c,d=[],e=[],f="translateStorageLocalstorage",g={},h="/",i=function(a,b){return h+b+"/i18n/"+a+".json"};this.fallbackLanguage=function(a){return b=a,this},this.provide=function(a,b,c){return d.push({lang:a,module:b,table:c}),this},this.addModule=function(a){return e.push(a),this},this.setStroageProvider=function(a){return f=a,this},this.setBaseUrl=function(a){return h=a,this},this.urlTemplate=function(a){return i=a,this},this.setPluralizationLoader=function(a){c=a},this.$get=["$q","$http","$interpolate","$injector","$rootScope","$locale","$sniffer","NgtLang",function(h,j,k,l,m,n,o,p){var q=l.get(f),r=function(a){return a in g==!1&&(g[a]=new p(i,a)),g[a]},s=function(a){var b=l.get(c);return b.load(a)},t=function(d){var e=function(d){var e=q.get()in g&&q.get()||b,f=r(e).getModules(),h=r(d);a.forEach(f,function(a){a.getAdded()&&h.getOrCreateModule(a.getName()).setAdded(!0)}),q.set(d),a.isDefined(c)&&s(d)};if(a.isUndefined(d)){var f=q.get()||b||"";if(0===f.length)throw new Error("No fallback language defined.");return f in g==!1&&e(f),f}return e(d),m.$emit("tLanguageChangedSuccessful",{language:d}),this},u=function(a){r(t()).getOrCreateModule(a).setAdded(!0)},v=function(){for(var a;a=e.pop();)u(a)},w=function(){for(var a,b;a=d.pop();)b=r(a.lang).getOrCreateModule(a.module),b.provide(a.table)},x=function(b,c,d){if(a.isString(c))return c;if(a.isObject(c)){var e=n.pluralCat(d.n),f=c[e];if(a.isUndefined(f))throw new Error("Plural form "+e+" ("+d.n+') for "'+b+'" is not provided');return f}throw new Error('No translation match for "'+b+'"')},y=function(a,b,c){var d=x(a,b,c);return k(d)(c)},z=function(b){return a.isUndefined(b)&&(b="undefined"),o.msie&&o.msie<=8&&(b=b.replace("<!--IE fix-->","")),b.trim()};return{translateLoaded:function(a,b){v(),w(),a=z(a);var c=g[t()].getTranslationLoaded(a);return c&&y(a,c,b)||void 0},translate:function(a,b){return v(),w(),a=z(a),g[t()].getTranslation(a).then(function(c){return y(a,c,b)})},use:t,addModule:function(a){return u(a),this},provide:function(a,b,c){return r(a).getOrCreateModule(b).provide(c),this},reload:function(a){var b=h.defer();return r(t()).getModule(a).reload().then(function(){b.resolve(this)}),b.promise},urlTemplate:function(){return i}}}]})}(angular);
//# sourceMappingURL=bessonov.ng-t.min.js.map